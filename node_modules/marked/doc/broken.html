<!doctype html><html><head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Scott Frees</title>

<style type='text/css'>
  *{margin:0;padding:0;}
  body {
    font:13.34px helvetica,arial,freesans,clean,sans-serif;
    color:black;
    line-height:1.4em;
    background-color: #F8F8F8;
    padding: 0.7em;
  }
  p {
    margin:1em 0;
    line-height:1.5em;
  }
  table {
    font-size:inherit;
    font:100%;
    margin-top:1em;
    margin-bottom:1em;
  }
  table th{border-bottom:1px solid #bbb;padding:.2em 1em;}
  table td{border-bottom:1px solid #ddd;padding:.2em 1em;}
  input[type=text],input[type=password],input[type=image],textarea{font:99% helvetica,arial,freesans,sans-serif;}
  select,option{padding:0 .25em;}
  optgroup{margin-top:.5em;}
  pre,code{font:12px Monaco,"Courier New","DejaVu Sans Mono","Bitstream Vera Sans Mono",monospace;}
  pre {
    margin:1em 0;
    font-size:12px;
    background-color:#eee;
    border:1px solid #ddd;
    padding:5px;
    line-height:1.5em;
    color:#444;
    overflow:auto;
    -webkit-box-shadow:rgba(0,0,0,0.07) 0 1px 2px inset;
    -webkit-border-radius:3px;
    -moz-border-radius:3px;border-radius:3px;
  }
  pre code {
    padding:0;
    font-size:12px;
    background-color:#eee;
    border:none;
  }
  code {
    font-size:12px;
    background-color:#f8f8ff;
    color:#444;
    padding:0 .2em;
    border:1px solid #dedede;
  }
  img{border:0;max-width:100%;}
  abbr{border-bottom:none;}
  a{color:#4183c4;text-decoration:none;}
  a:hover{text-decoration:underline;}
  a code,a:link code,a:visited code{color:#4183c4;}
  h2,h3{margin:1em 0;}
  h1,h2,h3,h4,h5,h6{border:0;}
  h1{font-size:170%;border-top:4px solid #aaa;padding-top:.5em;margin-top:1.5em;}
  h1:first-child{margin-top:0;padding-top:.25em;border-top:none;}
  h2{font-size:150%;margin-top:1.5em;border-top:4px solid #e0e0e0;padding-top:.5em;}
  h3{margin-top:1em;}
  hr{border:1px solid #ddd;}
  ul{margin:1em 0 1em 2em;}
  ol{margin:1em 0 1em 2em;}
  ul li,ol li{margin-top:.5em;margin-bottom:.5em;}
  ul ul,ul ol,ol ol,ol ul{margin-top:0;margin-bottom:0;}
  blockquote{margin:1em 0;border-left:5px solid #ddd;padding-left:.6em;color:#555;}
  dt{font-weight:bold;margin-left:1em;}
  dd{margin-left:2em;margin-bottom:1em;}
  sup {
      font-size: 0.83em;
      vertical-align: super;
      line-height: 0;
  }
  * {
    -webkit-print-color-adjust: exact;
  }

  .highlight {
    background-color:#f1c40f;
    padding-bottom:1em;
    padding-right:1em;
    padding-left:1em;
    font-weight:bold;
  }
  @media screen and (min-width: 914px) {
      body {
          width: 854px;
          margin:0 auto;
      }
  }
  @media print {
    table, pre {
      page-break-inside: avoid;
    }
    pre {
      word-wrap: break-word;
    }
  }


</style>

</head>
<h1 id="markdown-is-broken">Markdown is broken</h1>
<p>I have a lot of scraps of markdown engine oddities that I&#39;ve collected over the<br>years. What you see below is slightly messy, but it&#39;s what I&#39;ve managed to<br>cobble together to illustrate the differences between markdown engines, and<br>why, if there ever is a markdown specification, it has to be absolutely<br>thorough. There are a lot more of these little differences I have documented<br>elsewhere. I know I will find them lingering on my disk one day, but until<br>then, I&#39;ll continue to add whatever strange nonsensical things I find.</p>
<p>Some of these examples may only mention a particular engine compared to marked.<br>However, the examples with markdown.pl could easily be swapped out for<br>discount, upskirt, or markdown.js, and you would very easily see even more<br>inconsistencies.</p>
<p>A lot of this was written when I was very unsatisfied with the inconsistencies<br>between markdown engines. Please excuse the frustration noticeable in my<br>writing.</p>
<h2 id="examples-of-markdown-s-stupid-list-parsing">Examples of markdown&#39;s &quot;stupid&quot; list parsing</h2>
<pre><code>$ markdown.pl

  * item1

    * item2

  text
^D
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;item1&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;item2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;p&gt;text&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;
</code></pre><pre><code>$ marked
  * item1

    * item2

  text
^D
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;item1&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;item2&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;text&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>Which looks correct to you?</p>
<hr>
<pre><code>$ markdown.pl
* hello
  &gt; world
^D
&lt;p&gt;&lt;ul&gt;
&lt;li&gt;hello&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;world&lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</code></pre><pre><code>$ marked
* hello
  &gt; world
^D
&lt;ul&gt;
&lt;li&gt;hello&lt;blockquote&gt;
&lt;p&gt;world&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>Again, which looks correct to you?</p>
<hr>
<p>EXAMPLE:</p>
<pre><code>$ markdown.pl
* hello
  * world
    * hi
          code
^D
&lt;ul&gt;
&lt;li&gt;hello
&lt;ul&gt;
&lt;li&gt;world&lt;/li&gt;
&lt;li&gt;hi
  code&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>The code isn&#39;t a code block even though it&#39;s after the bullet margin. I know,<br>lets give it two more spaces, effectively making it 8 spaces past the bullet.</p>
<pre><code>$ markdown.pl
* hello
  * world
    * hi
            code
^D
&lt;ul&gt;
&lt;li&gt;hello
&lt;ul&gt;
&lt;li&gt;world&lt;/li&gt;
&lt;li&gt;hi
    code&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>And, it&#39;s still not a code block. Did you also notice that the 3rd item isn&#39;t<br>even its own list? Markdown screws that up too because of its indentation<br>unaware parsing.</p>
<hr>
<p>Let&#39;s look at some more examples of markdown&#39;s list parsing:</p>
<pre><code>$ markdown.pl

  * item1

    * item2

  text
^D
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;item1&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;item2&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;p&gt;text&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;
</code></pre><p>Misnested tags.</p>
<pre><code>$ marked
  * item1

    * item2

  text
^D
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;item1&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;item2&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;text&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>Which looks correct to you?</p>
<hr>
<pre><code>$ markdown.pl
* hello
  &gt; world
^D
&lt;p&gt;&lt;ul&gt;
&lt;li&gt;hello&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;world&lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</code></pre><p>More misnested tags.</p>
<pre><code>$ marked
* hello
  &gt; world
^D
&lt;ul&gt;
&lt;li&gt;hello&lt;blockquote&gt;
&lt;p&gt;world&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ul&gt;
</code></pre><p>Again, which looks correct to you?</p>
<hr>
<h1 id="why-quality-matters-part-2">Why quality matters - Part 2</h1>
<pre><code class="lang-bash">$ markdown.pl
* hello
  &gt; world
^D
&lt;p&gt;&lt;ul&gt;
&lt;li&gt;hello&lt;/p&gt;

&lt;blockquote&gt;
  &lt;p&gt;world&lt;/li&gt;
&lt;/ul&gt;&lt;/p&gt;
&lt;/blockquote&gt;
</code></pre>
<pre><code class="lang-bash">$ sundown # upskirt
* hello
  &gt; world
^D
&lt;ul&gt;
&lt;li&gt;hello
&amp;gt; world&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<pre><code class="lang-bash">$ marked
* hello
  &gt; world
^D
&lt;ul&gt;&lt;li&gt;hello &lt;blockquote&gt;&lt;p&gt;world&lt;/p&gt;&lt;/blockquote&gt;&lt;/li&gt;&lt;/ul&gt;
</code></pre>
<p>Which looks correct to you?</p>
<hr>
<p>See: <a href="https://github.com/evilstreak/markdown-js/issues/23">https://github.com/evilstreak/markdown-js/issues/23</a></p>
<pre><code class="lang-bash">$ markdown.pl # upskirt/markdown.js/discount
* hello
      var a = 1;
* world
^D
&lt;ul&gt;
&lt;li&gt;hello
var a = 1;&lt;/li&gt;
&lt;li&gt;world&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<pre><code class="lang-bash">$ marked
* hello
      var a = 1;
* world
^D
&lt;ul&gt;&lt;li&gt;hello
&lt;pre&gt;code&gt;var a = 1;&lt;/code&gt;&lt;/pre&gt;&lt;/li&gt;
&lt;li&gt;world&lt;/li&gt;&lt;/ul&gt;
</code></pre>
<p>Which looks more reasonable? Why shouldn&#39;t code blocks be able to appear in<br>list items in a sane way?</p>
<hr>
<pre><code class="lang-bash">$ markdown.js
&lt;div&gt;hello&lt;/div&gt;

&lt;span&gt;hello&lt;/span&gt;
^D
&lt;p&gt;&amp;lt;div&amp;gt;hello&amp;lt;/div&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;span&amp;gt;hello&amp;lt;/span&amp;gt;&lt;/p&gt;
</code></pre>
<pre><code class="lang-bash">$ marked
&lt;div&gt;hello&lt;/div&gt;

&lt;span&gt;hello&lt;/span&gt;
^D
&lt;div&gt;hello&lt;/div&gt;


&lt;p&gt;&lt;span&gt;hello&lt;/span&gt;
&lt;/p&gt;
</code></pre>
<hr>
<p>See: <a href="https://github.com/evilstreak/markdown-js/issues/27">https://github.com/evilstreak/markdown-js/issues/27</a></p>
<pre><code class="lang-bash">$ markdown.js
[![an image](/image)](/link)
^D
&lt;p&gt;&lt;a href=&quot;/image)](/link&quot;&gt;![an image&lt;/a&gt;&lt;/p&gt;
</code></pre>
<pre><code class="lang-bash">$ marked
[![an image](/image)](/link)
^D
&lt;p&gt;&lt;a href=&quot;/link&quot;&gt;&lt;img src=&quot;/image&quot; alt=&quot;an image&quot;&gt;&lt;/a&gt;
&lt;/p&gt;
</code></pre>
<hr>
<p>See: <a href="https://github.com/evilstreak/markdown-js/issues/24">https://github.com/evilstreak/markdown-js/issues/24</a></p>
<pre><code class="lang-bash">$ markdown.js
&gt; a

&gt; b

&gt; c
^D
&lt;blockquote&gt;&lt;p&gt;a&lt;/p&gt;&lt;p&gt;bundefined&amp;gt; c&lt;/p&gt;&lt;/blockquote&gt;
</code></pre>
<pre><code class="lang-bash">$ marked
&gt; a

&gt; b

&gt; c
^D
&lt;blockquote&gt;&lt;p&gt;a

&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;b

&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;c
&lt;/p&gt;&lt;/blockquote&gt;
</code></pre>
<hr>
<pre><code class="lang-bash">$ markdown.pl
* hello
  * world
    how

    are
    you

  * today
* hi
^D
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;hello&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;world
how&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;are
you&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;today&lt;/li&gt;
&lt;/ul&gt;&lt;/li&gt;
&lt;li&gt;hi&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
<pre><code class="lang-bash">$ marked
* hello
  * world
    how

    are
    you

  * today
* hi
^D
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;hello&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;world
how&lt;/p&gt;
&lt;p&gt;are
you&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;today&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;hi&lt;/li&gt;
&lt;/ul&gt;
</code></pre>
</html>